var t=function(e){this.config(e),this.cache={},this.mockModule("require",this.require.bind(this)),this.isRequired={},this.defineQueue=[],this.procWaiting=!1,this.Bound={},this.Bound.processDefineQueue=this.processDefineQueue.bind(this)},e=t.prototype;e.isNodeJs="undefined"!=typeof exports&&this.exports!==exports,e.config=function(e){if(this.cfg={baseUrl:"./"},"object"==typeof e)for(var i in e)e.hasOwnProperty(i)&&(this.cfg[i]=e[i])},e.define=function(e,i,t){var n=arguments.length;if(1===n&&(t=e,i=void 0,e=void 0),2===n&&(t=i,Array.isArray(e)?(i=e,e=void 0):i=void 0),"function"!=typeof t)throw new Error("Require module factory function: "+e);if(e&&this.cache[e])throw new Error("Found ambiguous module: "+e);var r={id:e,dependencies:i,factory:t,ready:!1,instance:null,listen:[],parent:null};e&&(this.cache[e]=r),this.defineQueue.push(r),this.procWaiting||(this.procWaiting=!0,this.onNextTick(this.Bound.processDefineQueue))},e.processDefineQueue=function(n,r){this.procWaiting=!1;var i=this.defineQueue;if(0!==i.length){for(var e,t=[];i.length;)e=i.pop(),e.parent=r,e.id||(e.id=n),t.push(e);for(;t.length;)e=t.pop(),creationResult=this.createModule(e)}},e.createModule=function(i){var s=i.dependencies,o=[],n=!1;if(void 0!==s){var r,c,e,t;for(r=0,c=s.length;c>r;r++)t=s[r],e=this.cache[t],e?e.ready?e=e.instance:(n=!0,e=this.listenOnCreation(e)):(n=!0,e=this.isRequired[t],e||(e=this.requireDependency(t,i),e instanceof Promise?this.isRequired[t]=e:n=!1)),o.push(e)}return this.cache[i.id]=i,n?i.instance=Promise.all(o).then(function(e){var t=i;return this.callFactoryCallback(t,e)}.bind(this)):this.callFactoryCallback(i,o),i},e.callFactoryCallback=function(e,n){e.instance=e.factory.apply(null,n),e.ready=!0,delete this.isRequired[e.id];var i,t;for(i=0,t=e.listen.length;t>i;i++)e.listen[i](e.instance);return delete e.listen,e},e.listenOnCreation=function(e){return new Promise(function(i){e.listen.push(function(e){i(e)})})},e.isNodeJs?e.requireDependency=function(e,t){require(this.normalizePath(this.cfg.baseUrl,e,t)),this.processDefineQueue(e,t);var i=this.cache[e];return i.ready?i.instance:new Promise(function(e){i.listen.push(function(i){e(i)})})}:(e.domDocumentHead=document.head,e.requireDependency=function(e,i){return new Promise(function(n){var t=document.createElement("script");t.src=this.normalizePath(this.cfg.baseUrl,e,i)+".js",t.type="text/javascript",t.charset="utf-8",t._moduleId=e,t.addEventListener("load",function(r){var t=r.target._moduleId;this.processDefineQueue(t,i);var e=this.cache[t];e.ready?n(e.instance):e.listen.push(function(e){n(e)})}.bind(this),!1),this.domDocumentHead.appendChild(t)}.bind(this))}),e.normalizePath=function(h,u,i){i={id:u,parent:i};for(var s="",o=!0;i;){var e=i.id;if(!e)break;if("/"===e.charAt(0)&&(e=e.substr(1)),"/"===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),o!==!0&&(e=e.substr(0,e.lastIndexOf("/")+1)),o=!1,s=e+s,"."!==e.charAt(0))break;i=i.parent}var n,t,c,a=(h+s).split("/"),r=[];for(t=0,c=a.length;c>t;t++)n=a[t],"."===n||(".."===n?r.pop():r.push(n));return r.join("/")},e.onNextTick=e.isNodeJs?function(e){process.nextTick(e)}:function(e){setTimeout(e,0)},e.require=function(e,i){return"string"==typeof e?this.cache[e].instance:void define.call(this,e,i)},e.mockModule=function(e,i){this.cache[e]={ready:!0,instance:i}};var i;e.isNodeJs?(i=GLOBAL,i.Minjector=new t({base:process.cwd()})):(i=window,i.Minjector=new t({base:"./"})),i.define=e.define.bind(i.Minjector),i.define.amd={};